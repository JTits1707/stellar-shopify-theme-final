{% comment %}
  Stellar Reverb Header Section
  Main navigation with cosmic design elements
{% endcomment %}

<header class="header" role="banner">
  <div class="header-wrapper">
    <div class="page-width">
      <div class="header-layout">
        
        <!-- Mobile Menu Toggle -->
        <button type="button" class="mobile-menu-toggle" aria-label="Open menu">
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
        </button>
        
        <!-- Logo -->
        <div class="header-logo">
          <a href="{{ routes.root_url }}" class="logo-link">
            {% if settings.brand_logo %}
              <img 
                src="{{ settings.brand_logo | image_url: width: 200 }}" 
                alt="{{ shop.name }}"
                class="logo-image"
                width="{{ section.settings.logo_width | default: 150 }}"
                height="auto"
              >
            {% else %}
              <span class="logo-text">{{ shop.name | default: 'STELLAR REVERB' }}</span>
            {% endif %}
          </a>
        </div>
        
        <!-- Main Navigation -->
        <nav class="main-nav" role="navigation" aria-label="Main navigation">
          <ul class="nav-list">
            {% for link in linklists[section.settings.menu].links %}
              <li class="nav-item">
                <a href="{{ link.url }}" class="nav-link">{{ link.title }}</a>
                
                {% if link.links != blank %}
                  <ul class="sub-nav">
                    {% for sublink in link.links %}
                      <li class="sub-nav-item">
                        <a href="{{ sublink.url }}" class="sub-nav-link">{{ sublink.title }}</a>
                      </li>
                    {% endfor %}
                  </ul>
                {% endif %}
              </li>
            {% endfor %}
            
            <!-- Signal Seekers Special Link -->
            {% if settings.enable_signal_seekers_nav %}
              <li class="nav-item signal-seekers-item">
                <a href="{{ settings.signal_seekers_url | default: '/pages/signal-seekers' }}" class="nav-link signal-seekers-nav">
                  <i class="fas fa-satellite-dish"></i>
                  Signal Seekers
                </a>
              </li>
            {% endif %}
          </ul>
        </nav>
        
        <!-- Header Actions -->
        <div class="header-actions">
          
          <!-- Search -->
          {% if section.settings.enable_search %}
            <div class="search-container">
              <button type="button" class="search-toggle" aria-label="Open search">
                <i class="fas fa-search"></i>
              </button>
              
              <div class="search-drawer" style="display: none;">
                <form action="{{ routes.search_url }}" method="get" class="search-form">
                  <input 
                    type="search" 
                    name="q" 
                    placeholder="Search transmissions..." 
                    class="search-input"
                    autocomplete="off"
                  >
                  <button type="submit" class="search-submit">
                    <i class="fas fa-search"></i>
                  </button>
                </form>
              </div>
            </div>
          {% endif %}
          
          <!-- Account -->
          <div class="account-container">
            <a href="{{ routes.account_url }}" class="account-link" aria-label="Account">
              <i class="fas fa-user"></i>
            </a>
          </div>
          
          <!-- Cart -->
          {% if section.settings.enable_cart_icon %}
            <div class="cart-container">
              <a href="{{ routes.cart_url }}" class="cart-link" aria-label="Cart">
                <i class="fas fa-shopping-cart"></i>
                <span class="cart-count" id="cart-count">{{ cart.item_count }}</span>
              </a>
            </div>
          {% endif %}
          
        </div>
      </div>
    </div>
  </div>
  
  <!-- Mobile Menu -->
  <div class="mobile-menu" style="display: none;">
    <div class="mobile-menu-content">
      <div class="mobile-menu-header">
        <span class="mobile-menu-title">Navigation</span>
        <button type="button" class="mobile-menu-close" aria-label="Close menu">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <nav class="mobile-nav">
        <ul class="mobile-nav-list">
          {% for link in linklists[section.settings.menu].links %}
            <li class="mobile-nav-item">
              <a href="{{ link.url }}" class="mobile-nav-link">{{ link.title }}</a>
              
              {% if link.links != blank %}
                <ul class="mobile-sub-nav">
                  {% for sublink in link.links %}
                    <li class="mobile-sub-nav-item">
                      <a href="{{ sublink.url }}" class="mobile-sub-nav-link">{{ sublink.title }}</a>
                    </li>
                  {% endfor %}
                </ul>
              {% endif %}
            </li>
          {% endfor %}
          
          {% if settings.enable_signal_seekers_nav %}
            <li class="mobile-nav-item signal-seekers-mobile">
              <a href="{{ settings.signal_seekers_url | default: '/pages/signal-seekers' }}" class="mobile-nav-link">
                <i class="fas fa-satellite-dish"></i>
                Signal Seekers
              </a>
            </li>
          {% endif %}
        </ul>
      </nav>
    </div>
  </div>
</header>

<style>
  .header {
    background: rgba(13, 13, 13, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 2px solid var(--neon-magenta);
    position: sticky;
    top: 0;
    z-index: 1000;
    transition: all 0.3s ease;
  }
  
  .header-wrapper {
    position: relative;
  }
  
  .header-layout {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1rem 0;
    position: relative;
  }
  
  /* Mobile Menu Toggle */
  .mobile-menu-toggle {
    display: none;
    flex-direction: column;
    background: none;
    border: none;
    cursor: pointer;
    padding: 0.5rem;
    gap: 0.3rem;
  }
  
  .hamburger-line {
    width: 25px;
    height: 3px;
    background: var(--neon-magenta);
    transition: all 0.3s ease;
    border-radius: 2px;
  }
  
  .mobile-menu-toggle.active .hamburger-line:nth-child(1) {
    transform: rotate(45deg) translate(6px, 6px);
  }
  
  .mobile-menu-toggle.active .hamburger-line:nth-child(2) {
    opacity: 0;
  }
  
  .mobile-menu-toggle.active .hamburger-line:nth-child(3) {
    transform: rotate(-45deg) translate(6px, -6px);
  }
  
  /* Logo */
  .header-logo {
    flex: 0 0 auto;
  }
  
  .logo-link {
    display: block;
    text-decoration: none;
  }
  
  .logo-image {
    max-height: 60px;
    width: auto;
    transition: all 0.3s ease;
  }
  
  .logo-image:hover {
    filter: drop-shadow(0 0 20px var(--neon-magenta));
  }
  
  .logo-text {
    font-family: 'Orbitron', monospace;
    font-weight: 900;
    font-size: 1.8rem;
    background: linear-gradient(45deg, var(--neon-magenta), var(--cyan-blue));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: 0 0 20px var(--neon-magenta);
    transition: all 0.3s ease;
  }
  
  .logo-text:hover {
    text-shadow: 0 0 30px var(--neon-magenta);
  }
  
  /* Main Navigation */
  .main-nav {
    flex: 1;
    display: flex;
    justify-content: center;
  }
  
  .nav-list {
    display: flex;
    align-items: center;
    gap: 2rem;
    list-style: none;
    margin: 0;
    padding: 0;
  }
  
  .nav-item {
    position: relative;
  }
  
  .nav-link {
    font-family: 'Orbitron', monospace;
    font-weight: 500;
    color: white;
    text-decoration: none;
    padding: 0.5rem 1rem;
    transition: all 0.3s ease;
    border-radius: 0.3rem;
    position: relative;
  }
  
  .nav-link:hover {
    color: var(--radioactive-green);
    text-shadow: 0 0 10px var(--radioactive-green);
    background: rgba(0, 240, 172, 0.1);
  }
  
  /* Signal Seekers Special Navigation */
  .signal-seekers-nav {
    border: 2px solid var(--neon-magenta) !important;
    background: rgba(225, 60, 250, 0.1) !important;
    border-radius: 0.5rem !important;
    padding: 0.5rem 1rem !important;
    animation: float-glow 3s ease-in-out infinite;
    position: relative;
    overflow: hidden;
  }
  
  .signal-seekers-nav::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    background: linear-gradient(45deg, var(--neon-magenta), var(--cyan-blue));
    border-radius: inherit;
    z-index: -1;
    animation: glitch-border 2s ease-in-out infinite;
  }
  
  .signal-seekers-nav i {
    margin-right: 0.5rem;
    animation: rotate-pulse 3s ease-in-out infinite;
  }
  
  @keyframes float-glow {
    0%, 100% { transform: translateY(0); box-shadow: 0 0 20px var(--neon-magenta); }
    50% { transform: translateY(-3px); box-shadow: 0 0 30px var(--neon-magenta); }
  }
  
  @keyframes glitch-border {
    0%, 100% { opacity: 1; }
    25% { opacity: 0.7; transform: translateX(1px); }
    50% { opacity: 1; transform: translateX(-1px); }
    75% { opacity: 0.8; transform: translateX(1px); }
  }
  
  @keyframes rotate-pulse {
    0%, 100% { transform: rotate(0deg) scale(1); }
    50% { transform: rotate(180deg) scale(1.1); }
  }
  
  /* Dropdown Navigation */
  .sub-nav {
    position: absolute;
    top: 100%;
    left: 0;
    background: rgba(13, 13, 13, 0.95);
    border: 2px solid var(--cyan-blue);
    border-radius: 0.5rem;
    padding: 0.5rem 0;
    min-width: 200px;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-10px);
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
    list-style: none;
    margin: 0;
    z-index: 100;
  }
  
  .nav-item:hover .sub-nav {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }
  
  .sub-nav-link {
    display: block;
    padding: 0.5rem 1rem;
    color: white;
    text-decoration: none;
    font-family: 'Montserrat', sans-serif;
    transition: all 0.3s ease;
  }
  
  .sub-nav-link:hover {
    background: rgba(40, 168, 214, 0.1);
    color: var(--cyan-blue);
  }
  
  /* Header Actions */
  .header-actions {
    display: flex;
    align-items: center;
    gap: 1rem;
    flex: 0 0 auto;
  }
  
  .search-container,
  .account-container,
  .cart-container {
    position: relative;
  }
  
  .search-toggle,
  .account-link,
  .cart-link {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: none;
    border: 2px solid var(--cyan-blue);
    border-radius: 50%;
    color: var(--cyan-blue);
    text-decoration: none;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
  }
  
  .search-toggle:hover,
  .account-link:hover,
  .cart-link:hover {
    border-color: var(--radioactive-green);
    color: var(--radioactive-green);
    box-shadow: 0 0 20px rgba(0, 240, 172, 0.3);
  }
  
  .cart-count {
    position: absolute;
    top: -8px;
    right: -8px;
    background: var(--electric-yellow);
    color: var(--void-black);
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.7rem;
    font-weight: 700;
    font-family: 'Orbitron', monospace;
  }
  
  /* Search Drawer */
  .search-drawer {
    position: absolute;
    top: 100%;
    right: 0;
    background: rgba(13, 13, 13, 0.95);
    border: 2px solid var(--cyan-blue);
    border-radius: 0.5rem;
    padding: 1rem;
    min-width: 300px;
    backdrop-filter: blur(10px);
    z-index: 100;
  }
  
  .search-form {
    display: flex;
    gap: 0.5rem;
  }
  
  .search-input {
    flex: 1;
    padding: 0.8rem;
    background: rgba(13, 13, 13, 0.8);
    border: 2px solid var(--cyan-blue);
    border-radius: 0.5rem;
    color: white;
    font-family: 'Montserrat', sans-serif;
  }
  
  .search-input::placeholder {
    color: rgba(255, 255, 255, 0.5);
    font-style: italic;
  }
  
  .search-input:focus {
    outline: none;
    border-color: var(--neon-magenta);
    box-shadow: 0 0 20px rgba(225, 60, 250, 0.3);
  }
  
  .search-submit {
    background: var(--cyan-blue);
    color: var(--void-black);
    border: none;
    border-radius: 0.5rem;
    padding: 0.8rem 1rem;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .search-submit:hover {
    background: var(--radioactive-green);
  }
  
  /* Mobile Menu */
  .mobile-menu {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(10px);
    z-index: 9999;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
  }
  
  .mobile-menu.active {
    opacity: 1;
    visibility: visible;
  }
  
  .mobile-menu-content {
    background: linear-gradient(135deg, rgba(13, 13, 13, 0.95), rgba(225, 60, 250, 0.1));
    border: 2px solid var(--neon-magenta);
    border-radius: 1rem;
    margin: 2rem;
    padding: 2rem;
    max-height: calc(100vh - 4rem);
    overflow-y: auto;
    transform: scale(0.8);
    transition: all 0.3s ease;
  }
  
  .mobile-menu.active .mobile-menu-content {
    transform: scale(1);
  }
  
  .mobile-menu-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid var(--cyan-blue);
  }
  
  .mobile-menu-title {
    font-family: 'Orbitron', monospace;
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--neon-magenta);
  }
  
  .mobile-menu-close {
    background: none;
    border: 2px solid var(--neon-magenta);
    color: var(--neon-magenta);
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .mobile-menu-close:hover {
    background: var(--neon-magenta);
    color: var(--void-black);
    transform: rotate(90deg);
  }
  
  .mobile-nav-list {
    list-style: none;
    margin: 0;
    padding: 0;
  }
  
  .mobile-nav-item {
    margin-bottom: 1rem;
  }
  
  .mobile-nav-link {
    display: block;
    padding: 1rem;
    background: rgba(40, 168, 214, 0.1);
    border: 1px solid var(--cyan-blue);
    border-radius: 0.5rem;
    color: white;
    text-decoration: none;
    font-family: 'Orbitron', monospace;
    font-weight: 500;
    transition: all 0.3s ease;
  }
  
  .mobile-nav-link:hover {
    background: rgba(40, 168, 214, 0.2);
    border-color: var(--radioactive-green);
    color: var(--radioactive-green);
  }
  
  .signal-seekers-mobile .mobile-nav-link {
    background: rgba(225, 60, 250, 0.1);
    border-color: var(--neon-magenta);
    animation: pulse-glow 2s ease-in-out infinite;
  }
  
  .mobile-sub-nav {
    list-style: none;
    margin: 0.5rem 0 0 1rem;
    padding: 0;
  }
  
  .mobile-sub-nav-link {
    display: block;
    padding: 0.5rem 1rem;
    color: rgba(255, 255, 255, 0.8);
    text-decoration: none;
    font-family: 'Montserrat', sans-serif;
    transition: all 0.3s ease;
  }
  
  .mobile-sub-nav-link:hover {
    color: var(--cyan-blue);
  }
  
  /* Responsive Design */
  @media (max-width: 768px) {
    .mobile-menu-toggle {
      display: flex;
    }
    
    .main-nav {
      display: none;
    }
    
    .header-actions {
      gap: 0.5rem;
    }
    
    .search-drawer {
      min-width: 250px;
    }
    
    .logo-text {
      font-size: 1.4rem;
    }
  }
  
  @media (max-width: 480px) {
    .header-layout {
      padding: 0.5rem 0;
    }
    
    .search-drawer {
      min-width: 200px;
      right: -50px;
    }
    
    .mobile-menu-content {
      margin: 1rem;
      padding: 1rem;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Mobile menu toggle
    const mobileToggle = document.querySelector('.mobile-menu-toggle');
    const mobileMenu = document.querySelector('.mobile-menu');
    const mobileClose = document.querySelector('.mobile-menu-close');
    
    function openMobileMenu() {
      mobileMenu.classList.add('active');
      mobileToggle.classList.add('active');
      document.body.style.overflow = 'hidden';
    }
    
    function closeMobileMenu() {
      mobileMenu.classList.remove('active');
      mobileToggle.classList.remove('active');
      document.body.style.overflow = '';
    }
    
    mobileToggle?.addEventListener('click', openMobileMenu);
    mobileClose?.addEventListener('click', closeMobileMenu);
    
    // Close mobile menu on backdrop click
    mobileMenu?.addEventListener('click', function(e) {
      if (e.target === mobileMenu) {
        closeMobileMenu();
      }
    });
    
    // Search toggle
    const searchToggle = document.querySelector('.search-toggle');
    const searchDrawer = document.querySelector('.search-drawer');
    
    searchToggle?.addEventListener('click', function() {
      const isVisible = searchDrawer.style.display !== 'none';
      searchDrawer.style.display = isVisible ? 'none' : 'block';
      
      if (!isVisible) {
        searchDrawer.querySelector('.search-input')?.focus();
      }
    });
    
    // Close search on outside click
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.search-container')) {
        searchDrawer.style.display = 'none';
      }
    });
    
    // Header scroll effect
    let lastScrollY = window.scrollY;
    
    window.addEventListener('scroll', function() {
      const header = document.querySelector('.header');
      const currentScrollY = window.scrollY;
      
      if (currentScrollY > lastScrollY && currentScrollY > 100) {
        // Scrolling down
        header.style.transform = 'translateY(-100%)';
      } else {
        // Scrolling up
        header.style.transform = 'translateY(0)';
      }
      
      lastScrollY = currentScrollY;
    });
    
    // Update cart count (this would be connected to Shopify's cart API)
    function updateCartCount() {
      fetch('/cart.js')
        .then(response => response.json())
        .then(cart => {
          const cartCount = document.getElementById('cart-count');
          if (cartCount) {
            cartCount.textContent = cart.item_count;
            cartCount.style.display = cart.item_count > 0 ? 'flex' : 'none';
          }
        })
        .catch(error => console.error('Error updating cart count:', error));
    }
    
    // Update cart count on page load
    updateCartCount();
    
    // Listen for cart updates
    document.addEventListener('cart:updated', updateCartCount);
  });
</script>

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "range",
      "id": "logo_width",
      "label": "Logo width",
      "min": 100,
      "max": 300,
      "step": 10,
      "unit": "px",
      "default": 150
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu",
      "default": "main-menu"
    },
    {
      "type": "checkbox",
      "id": "enable_search",
      "label": "Enable search",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_cart_icon",
      "label": "Enable cart icon",
      "default": true
    }
  ]
}
{% endschema %}
